<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ูุชุฌุฑู</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="store.css">
  <script type="module">
    import { supabase } from './js/server-superbase.js';
  
    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get("id");
  
    // ุฏุงูุฉ ูุณุงุนุฏุฉ ููุชุญูู ูู ุตุญุฉ ูุนุฑู ุงูุจููุณู
    function isValidPixelId(pixelId) {
      return pixelId && !isNaN(pixelId) && pixelId > 0 && Number.isInteger(Number(pixelId));
    }

    // ุฏุงูุฉ ูุณุงุนุฏุฉ ููุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุจููุณู
    function validatePixelData(pixelData) {
      if (!pixelData || typeof pixelData !== 'object') {
        return { valid: false, error: "ุจูุงูุงุช ุงูุจููุณู ุบูุฑ ุตุงูุญุฉ" };
      }
      
      if (!pixelData.id || !pixelData.pixel_name || !pixelData.pixel_code) {
        return { valid: false, error: "ุจูุงูุงุช ุงูุจููุณู ูุงูุตุฉ" };
      }
      
      return { valid: true };
    }

    async function injectDynamicPixel() {
      try {
        console.log("๐ ุจุฏุก ุชุญููู ุงูุจููุณู ุงูุฑุฆูุณู...");
        
        // ุงุณุชุฎุฑุงุฌ subdomain ุจุดูู ุนุงู ูู hostname ุฃู ?subdomain=
        let subdomain = (typeof window.extractSubdomain === 'function') ? window.extractSubdomain() : 'default';
        
        console.log('Subdomain detected:', subdomain);
        
        // ุฌูุจ ูุนูููุงุช ุงููุชุฌุฑ ุนุจุฑ subdomain
        const { data: storeData, error: storeError } = await supabase
          .from('stores')
          .select('id, name, subdomain')
          .eq('subdomain', subdomain)
          .single();
        
        if (storeError || !storeData) {
          console.error('Store not found for subdomain:', subdomain);
          return;
        }
        
        console.log('Store found:', storeData);
        
        // ุฌูุจ id ุงูุจููุณู ุงูุฑุฆูุณู ูู ุฅุนุฏุงุฏุงุช ุงููุชุฌุฑ
        const { data: settings, error: settingsError } = await supabase
          .from('store_settings')
          .select('main_pixel')
          .eq('store_id', storeData.id)
          .single();

        // ุงูุชุญูู ูู ูุฌูุฏ ุฎุทุฃ ูู ุงูุงุณุชุนูุงู
        if (settingsError) {
          console.error("โ ุฎุทุฃ ูู ุฌูุจ ุฅุนุฏุงุฏุงุช ุงููุชุฌุฑ:", settingsError.message);
          return;
        }

        // ุงูุชุญูู ูู ูุฌูุฏ ุงูุจูุงูุงุช
        if (!settings) {
          console.warn("โ๏ธ ูุง ุชูุฌุฏ ุฅุนุฏุงุฏุงุช ูุชุฌุฑ");
          return;
        }

        // ุงูุชุญูู ูู ูุฌูุฏ main_pixel
        if (!settings.main_pixel) {
          console.warn("โ๏ธ ูุง ููุฌุฏ ุจููุณู ุฑุฆูุณู ูุญุฏุฏ ูู ุฅุนุฏุงุฏุงุช ุงููุชุฌุฑ");
          return;
        }

        const pixelId = settings.main_pixel;
        console.log("๐ ูุนุฑู ุงูุจููุณู ุงููุญููุธ:", pixelId);

        // ุงูุชุญูู ูู ุตุญุฉ ูุนุฑู ุงูุจููุณู ุจุงุณุชุฎุฏุงู ุงูุฏุงูุฉ ุงููุณุงุนุฏุฉ
        if (!isValidPixelId(pixelId)) {
          console.error("โ ูุนุฑู ุงูุจููุณู ุบูุฑ ุตุงูุญ:", pixelId);
          return;
        }

        // ุฌูุจ ููุฏ ุงูุจููุณู ูู ุฌุฏูู ad_pixels
        const { data: pixelData, error: pixelError } = await supabase
          .from('ad_pixels')
          .select('id, pixel_name, pixel_code')
          .eq('id', pixelId)
          .eq('store_id', storeData.id)
          .single();

        // ุงูุชุญูู ูู ูุฌูุฏ ุฎุทุฃ ูู ุงูุงุณุชุนูุงู
        if (pixelError) {
          console.error("โ ุฎุทุฃ ูู ุฌูุจ ุจูุงูุงุช ุงูุจููุณู:", pixelError.message);
          return;
        }

        // ุงูุชุญูู ูู ูุฌูุฏ ุจูุงูุงุช ุงูุจููุณู
        if (!pixelData) {
          console.error("โ ุงูุจููุณู ุบูุฑ ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช");
          return;
        }

        // ุงูุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุจููุณู ุจุงุณุชุฎุฏุงู ุงูุฏุงูุฉ ุงููุณุงุนุฏุฉ
        const validation = validatePixelData(pixelData);
        if (!validation.valid) {
          console.error("โ ุจูุงูุงุช ุงูุจููุณู ุบูุฑ ุตุงูุญุฉ:", validation.error);
          return;
        }

        console.log("๐ ุจูุงูุงุช ุงูุจููุณู ุงููุญููุฉ:", {
          id: pixelData.id,
          name: pixelData.pixel_name,
          code_type: typeof pixelData.pixel_code
        });

        // ุชุญููู JSONB
        let pixelType, pixelCode;
        try {
          let parsed;
          
          // ุงูุชุญูู ูู ููุน ุงูุจูุงูุงุช
          if (typeof pixelData.pixel_code === 'string') {
            parsed = JSON.parse(pixelData.pixel_code);
          } else if (typeof pixelData.pixel_code === 'object' && pixelData.pixel_code !== null) {
            parsed = pixelData.pixel_code;
          } else {
            throw new Error("ููุน ุงูุจูุงูุงุช ุบูุฑ ุตุงูุญ");
          }

          // ุงูุชุญูู ูู ูุฌูุฏ ุงูุญููู ุงููุทููุจุฉ
          if (!parsed.type || !parsed.code) {
            throw new Error("ุงูุจูุงูุงุช ูุงูุตุฉ - ูุฌุจ ุฃู ูุญุชูู ุนูู type ู code");
          }

          pixelType = parsed.type;
          pixelCode = parsed.code;

          // ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
          if (typeof pixelType !== 'string' || typeof pixelCode !== 'string') {
            throw new Error("ููุน ุงูุจูุงูุงุช ุบูุฑ ุตุญูุญ");
          }

          console.log("โ ุชู ุชุญููู ุจูุงูุงุช ุงูุจููุณู ุจูุฌุงุญ");
        } catch (e) {
          console.error("โ ุฎุทุฃ ูู ุชุญููู JSON ุงูุจููุณู:", e.message);
          console.error("ุงูุจูุงูุงุช ุงูุฃุตููุฉ:", pixelData.pixel_code);
          return;
        }

        console.log("๐ ููุน ุงูุจููุณู:", pixelType, " | ููุฏ:", pixelCode);
        
        // ุงูุชุญูู ูู ุตุญุฉ ููุฏ ุงูุจููุณู
        if (!pixelCode || pixelCode.trim() === '') {
          console.error("โ ููุฏ ุงูุจููุณู ูุงุฑุบ ุฃู ุบูุฑ ุตุงูุญ");
          return;
        }

        // ุชูุธูู ููุฏ ุงูุจููุณู ูู ุงููุณุงูุงุช ุงูุฒุงุฆุฏุฉ
        pixelCode = pixelCode.trim();
  
        // ุชูุนูู ุงูุจููุณู ุญุณุจ ุงูููุน
        if (pixelType === 'facebook_pixel') {
          // ุชุนุฑูู fbq ูุจู ุชุญููู ุฃู ุณูุฑูุจุช
          window.fbq = window.fbq || function() {
            (window.fbq.callMethod ? window.fbq.callMethod.apply(window.fbq, arguments) : window.fbq.queue.push(arguments));
          };
          window.fbq.push = window.fbq;
          window.fbq.loaded = true;
          window.fbq.version = '2.0';
          window.fbq.queue = [];
  
          // ุชููุฆุฉ ุงูุจููุณู ููุฑุงู
          window.fbq('init', pixelCode);
          console.log('๐ง ุชู ุชููุฆุฉ Facebook Pixel:', pixelCode);
  
          // ุชุญููู Facebook Pixel SDK
          const fbScript = document.createElement('script');
          fbScript.src = 'https://connect.facebook.net/en_US/fbevents.js';
          fbScript.async = true;
          document.head.appendChild(fbScript);
  
          fbScript.onload = () => {
            try {
              // ุชุชุจุน PageView
              window.fbq('track', 'PageView');
              console.log('๐ ุชู ุชุชุจุน PageView');
              
              // ุชุชุจุน ViewContent ูุน ุจูุงูุงุช ุงูููุชุฌ
              window.fbq('track', 'ViewContent', {
                content_type: 'product',
                content_ids: [productId],
                content_name: 'Product View',
                value: 0,
                currency: 'USD'
              });
              console.log('๐๏ธ ุชู ุชุชุจุน ViewContent ููููุชุฌ:', productId);
  
              // ุฅุถุงูุฉ ูุญุต ุฅุถุงูู ููุชุฃูุฏ ูู ุฅุฑุณุงู ุงูุจูุงูุงุช
              setTimeout(() => {
                console.log('๐ ูุญุต ุญุงูุฉ Facebook Pixel...');
                if (window.fbq && window.fbq.queue) {
                  console.log('โ Facebook Pixel ูุนูู ุจุดูู ุตุญูุญ');
                } else {
                  console.warn('โ๏ธ Facebook Pixel ูุฏ ูุง ูุนูู ุจุดูู ุตุญูุญ');
                }
              }, 2000);
  
              console.log('โ Facebook Pixel ุชู ุชููุฆุชู ุจูุฌุงุญ:', pixelCode);
            } catch (error) {
              console.error('โ ุฎุทุฃ ูู ุชููุฆุฉ Facebook Pixel:', error);
            }
          };
        }
  
        else if (pixelType === 'tiktok_pixel') {
          // ุชุนุฑูู ttq ููุชุบูุฑ ุนุงู ุฃููุงู
          window.ttq = window.ttq || [];
          
          const ttScript = document.createElement('script');
          ttScript.src = 'https://analytics.tiktok.com/i18n/pixel/sdk.js?sdkid=' + pixelCode + '&lib=ttq';
          ttScript.async = true;
          document.head.appendChild(ttScript);
  
          ttScript.onload = () => {
            // ุงูุชุฃูุฏ ูู ูุฌูุฏ ttq ูุจู ุงุณุชุฎุฏุงูู
            if (window.ttq && Array.isArray(window.ttq)) {
              window.ttq.push(['init', pixelCode]);
              window.ttq.push(['track', 'PageView']);
              window.ttq.push(['track', 'ViewContent']);
            }
          };
        }
  
        // ูููู ุฅุถุงูุฉ ุฃููุงุน ุฃุฎุฑู ููุง (Google, Snapchat, ุฅูุฎ)
        else {
          console.warn("โ๏ธ ููุน ุงูุจููุณู ุบูุฑ ูุฏุนูู:", pixelType);
        }
  
      } catch (err) {
        console.error("โ ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ุงูุจููุณู:", err);
        console.error("ุชูุงุตูู ุงูุฎุทุฃ:", {
          message: err.message,
          stack: err.stack
        });
      }
    }
  
    // ุชุดุบูู ุงูุฏุงูุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ ูุน ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
    document.addEventListener('DOMContentLoaded', () => {
      console.log("๐ ุชู ุชุญููู ุงูุตูุญุฉุ ุจุฏุก ุชุญููู ุงูุจููุณู...");
      injectDynamicPixel().catch(error => {
        console.error("โ ุฎุทุฃ ุบูุฑ ูุชููุน ูู ุชุญููู ุงูุจููุณู:", error);
      });
    });
  </script>
  <script>
    // ุฏุงูุฉ ูุงุณุชุฎุฑุงุฌ subdomain ูู ุงูุฑุงุจุท/ุงูุฏูููู ูุน ุฏุนู safiastore.shop ูุจุฏุงุฆู ุนุงูุฉ
    window.extractSubdomain = function() {
      try {
        const url = new URL(window.location.href);
        const qp = url.searchParams.get('subdomain');
        if (qp && qp.trim()) return qp.trim();

        const host = window.location.hostname;
        const parts = host.split('.');
        // ูุงุนุฏุฉ ุนุงูุฉ: ุฅุฒุงูุฉ ุขุฎุฑ ุฌุฒุฆูู (ุงูุฏูููู ุงูุฃุณุงุณู ูุงูู TLD)
        if (parts.length > 2) return parts.slice(0, -2).join('.');
        return 'default';
      } catch (_) {
        return 'default';
      }
    };

    // ุชูุงูู ูุน ุฏูุงู ุญุงููุฉ ุฅู ููุฌุฏุช ุฏูู ุงููุชุงุจุฉ ููููุง
    if (typeof window.getCurrentSubdomain !== 'function') {
      window.getCurrentSubdomain = function() { return window.extractSubdomain(); };
    }

    // ุฏุงูุฉ ูุณุงุนุฏุฉ ูุฌูุจ ุจูุงูุงุช ุงููุชุฌุฑ ุงูุฃุณุงุณูุฉ ุญุณุจ subdomain (stores, store_settings)
    window.fetchStoreContext = async function() {
      try {
        const subdomain = window.extractSubdomain();
        if (!window.supabase) {
          console.error('Supabase SDK ุบูุฑ ูุญููู ุจุนุฏ');
          return null;
        }

        const { data: store, error: storeError } = await window.supabase
          .from('stores')
          .select('id, name, subdomain, domain, is_active')
          .eq('subdomain', subdomain)
          .eq('is_active', true)
          .single();

        if (storeError || !store) {
          console.error('ุชุนุฐูุฑ ุงูุนุซูุฑ ุนูู ุงููุชุฌุฑ ูู subdomain:', subdomain, storeError);
          return null;
        }

        const { data: settings } = await window.supabase
          .from('store_settings')
          .select('*')
          .eq('store_id', store.id)
          .single();

        return { store, settings };
      } catch (e) {
        console.error('ุฎุทุฃ ุฃุซูุงุก ุฌูุจ ุณูุงู ุงููุชุฌุฑ:', e);
        return null;
      }
    };
  </script>
  <script>
    // ูุฑุถ ูุฌูุฏ subdomain ูู ุฑุงุจุท ุงูุตูุญุฉ ุฅู ูุงู ูุชุงุญุงู ูู hostname ููู ูููุฑููุฑ ูู query
    (function ensureSubdomainInUrl(){
      try {
        const params = new URLSearchParams(window.location.search);
        const hasParam = params.has('subdomain');
        const sub = (typeof window.extractSubdomain === 'function') ? window.extractSubdomain() : 'default';
        if (!hasParam && sub && sub !== 'default') {
          params.set('subdomain', sub);
          const newUrl = `${window.location.pathname}?${params.toString()}`;
          window.history.replaceState({}, '', newUrl);
        }
        if (sub && sub !== 'default') {
          try { localStorage.setItem('lastSubdomain', sub); } catch(_) {}
        }
      } catch(_) {}
    })();
  </script>
</head>
<body>
  


  <!-- ุงูุดุฑูุท ุงูุนููู -->
  <div class="top-banner">
    ุงูุชูุตูู ุงูุณุฑูุน ุฎูุงู 24 ุณุงุนุฉ ู ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู
  </div>

  <!-- ุงูููุฏุฑ ุงูุฑุฆูุณู -->
  <header class="main-header">
    <!-- ุงูุดุนุงุฑ -->
    <div class="logo-section">
      <img id="store-logo" src="https://cdn-icons-png.flaticon.com/512/263/263142.png" alt="ุดุนุงุฑ ุงููุชุฌุฑ">
      <div class="logo-underline"></div>
    </div>
    
    <!-- ุฑูุงุจุท ุงูุชููู -->
    <nav class="nav-links">
      <a href="index.html" id="nav-home">ุงูุฑุฆูุณูุฉ</a>
      <a href="category.html" id="nav-category">ุงูุชุตูููุงุช</a>
      <a href="all-products.html" id="nav-products">ูู ุงูููุชุฌุงุช</a>
      <a href="about-us.html" id="nav-about">ุนู ุงููุชุฌุฑ</a>
    </nav>

    <!-- ุฒุฑ ุงููุงุฆูุฉ ููููุงุชู -->
    <button class="menu-btn" onclick="toggleSidebar()">
      <i class="bi bi-list"></i>
    </button>

    

    <!-- ุฒุฑ ุงูุจุญุซ ููููุงุชู -->
    <button class="search-modal-btn" onclick="openSearchModal()">
      <i class="bi bi-search"></i>
    </button>
  </header>

  <!-- ููุฏู ุงูุจุญุซ -->
  <div class="search-modal" id="search-modal">
    <div class="search-modal-content">
      <div class="search-modal-header">
        <h5>ุงูุจุญุซ ุนู ุงูููุชุฌุงุช</h5>
        <button class="search-modal-close" onclick="closeSearchModal()">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>
      <input type="text" id="search-modal-input" class="search-modal-input" placeholder="ุงูุชุจ ุงุณู ุงูููุชุฌ..." onkeyup="if(event.key === 'Enter') performModalSearch()">
      <button class="search-modal-btn-submit" onclick="performModalSearch()">
        <i class="bi bi-search"></i> ุจุญุซ
      </button>
    </div>
  </div>

  <!-- ููุฏู ุงูููุชุฑุฉ -->
  <div class="filter-modal" id="filter-modal">
    <div class="filter-modal-content">
      <div class="filter-modal-header">
        <h5>ููุชุฑ ุงูููุชุฌุงุช</h5>
        <button class="filter-modal-close" onclick="closeFilterModal()">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>
      <div class="filter-modal-body">
        <div class="mb-3">
          <label class="form-label">ุงูุชุตููู</label>
          <select id="mobile-category-filter" class="form-select">
            <option value="">ุฌููุน ุงูุชุตูููุงุช</option>
            <!-- ุณูุชู ุชุนุจุฆุฉ ุงูุชุตูููุงุช ุฏููุงููููุงู -->
          </select>
        </div>
        
        <div class="mb-3">
          <label class="form-label">ุงูุณุนุฑ</label>
          <select id="mobile-price-filter" class="form-select">
            <option value="">ุฌููุน ุงูุฃุณุนุงุฑ</option>
            <option value="0-1000">ุฃูู ูู 1000 ุฏุฌ</option>
            <option value="1000-5000">1000 - 5000 ุฏุฌ</option>
            <option value="5000-10000">5000 - 10000 ุฏุฌ</option>
            <option value="10000+">ุฃูุซุฑ ูู 10000 ุฏุฌ</option>
          </select>
        </div>
        
        <div class="mb-3">
          <label class="form-label">ุงูุชุฑุชูุจ</label>
          <select id="mobile-sort-filter" class="form-select">
            <option value="newest">ุงูุฃุญุฏุซ</option>
            <option value="oldest">ุงูุฃูุฏู</option>
            <option value="price-low">ุงูุณุนุฑ: ูู ุงูุฃูู ููุฃุนูู</option>
            <option value="price-high">ุงูุณุนุฑ: ูู ุงูุฃุนูู ููุฃูู</option>
            <option value="name-asc">ุงูุงุณู: ุฃ-ู</option>
            <option value="name-desc">ุงูุงุณู: ู-ุฃ</option>
          </select>
        </div>
        
        <div class="mb-3">
          <button id="mobile-clear-filters" class="btn btn-outline-secondary w-100">
            <i class="fas fa-redo"></i> ุฅุนุงุฏุฉ ุชุนููู
          </button>
        </div>
      </div>
      <div class="filter-modal-footer">
        <button class="btn btn-secondary" onclick="closeFilterModal()">ุฅุบูุงู</button>
        <button class="btn btn-primary" onclick="applyMobileFilters()">ุชุทุจูู ุงูููุชุฑุฉ</button>
      </div>
    </div>
  </div>

  <!-- ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
  <div class="sidebar-overlay" onclick="closeSidebar()"></div>
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h5>ุงููุงุฆูุฉ</h5>
      <button class="sidebar-close" onclick="closeSidebar()">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>
    <ul class="sidebar-nav">
      <li><a href="index.html" id="sidebar-home"><i class="bi bi-house-door"></i> ุงูุฑุฆูุณูุฉ</a></li>
      <li><a href="category.html" id="sidebar-category"><i class="bi bi-grid"></i> ุงูุชุตูููุงุช</a></li>
      <li><a href="all-products.html" id="sidebar-products"><i class="bi bi-bag"></i> ูู ุงูููุชุฌุงุช</a></li>
      <li><a href="about-us.html" id="sidebar-about"><i class="bi bi-info-circle"></i> ุนู ุงููุชุฌุฑ</a></li>
    </ul>
    
    <!-- ุฒุฑ ุฅุธูุงุฑ/ุฅุฎูุงุก ุงูููุงุชุฑ -->
    <div class="sidebar-filter-toggle">
      <button class="btn btn-outline-primary w-100" onclick="toggleSidebarFilters()">
        <i class="bi bi-funnel"></i> ุฅุธูุงุฑ ุงูููุงุชุฑ
      </button>
    </div>
    
    <!-- ูุณู ุงูููุงุชุฑ ูู ุงูุณุงูุฏ ุจุงุฑ -->
    <div class="sidebar-filters" id="sidebar-filters">
      <h6>ููุชุฑ ุงูุชุตูููุงุช</h6>
      <select id="sidebar-category-filter" class="form-select">
        <option value="">ุฌููุน ุงูุชุตูููุงุช</option>
        <!-- ุณูุชู ุชุนุจุฆุฉ ุงูุชุตูููุงุช ุฏููุงููููุงู -->
      </select>
      
      <h6>ููุชุฑ ุงูุณุนุฑ</h6>
      <select id="sidebar-price-filter" class="form-select">
        <option value="">ุฌููุน ุงูุฃุณุนุงุฑ</option>
        <option value="0-1000">ุฃูู ูู 1000 ุฏุฌ</option>
        <option value="1000-5000">1000 - 5000 ุฏุฌ</option>
        <option value="5000-10000">5000 - 10000 ุฏุฌ</option>
        <option value="10000+">ุฃูุซุฑ ูู 10000 ุฏุฌ</option>
      </select>
      
      <h6>ุงูุชุฑุชูุจ</h6>
      <select id="sidebar-sort-filter" class="form-select">
        <option value="newest">ุงูุฃุญุฏุซ</option>
        <option value="oldest">ุงูุฃูุฏู</option>
        <option value="price-low">ุงูุณุนุฑ: ูู ุงูุฃูู ููุฃุนูู</option>
        <option value="price-high">ุงูุณุนุฑ: ูู ุงูุฃุนูู ููุฃูู</option>
        <option value="name-asc">ุงูุงุณู: ุฃ-ู</option>
        <option value="name-desc">ุงูุงุณู: ู-ุฃ</option>
      </select>
      
      <button id="sidebar-clear-filters" class="btn btn-outline-secondary w-100">
        <i class="fas fa-redo"></i> ุฅุนุงุฏุฉ ุชุนููู
      </button>
      
      <button class="btn btn-primary w-100" onclick="applySidebarFilters()">
        <i class="bi bi-check"></i> ุชุทุจูู ุงูููุชุฑุฉ
      </button>
    </div>
  </div>

  <main class="container py-5">
    <div class="section-heading-content text-center mb-3">
      <h1 class="section-title">
        ููุชุฌุงุชูุง ุฃุตููุฉ ู ุฐุงุช ุฌูุฏุฉ ุนุงููุฉ
      </h1>
      <p class="section-subtitle" style="color: #6c757d; font-size: 1.4rem; font-weight: 400; margin-top: 15px;">ุชุตูุญ ูุงุฆูุฉ ุงูููุชุฌุงุช ุงูุฃูุซุฑ ุฑูุงุฌุง</p>
    </div>
    <h2 class="mb-4">ุงูููุชุฌุงุช ุงููููุฒุฉ</h2>

    <!-- ุฒุฑ ุงูููุชุฑุฉ ููููุงุชู -->
    <button class="filter-btn" onclick="openFilterModal()">
      <i class="bi bi-filter"></i> ููุชุฑ
    </button>
    <br>
    
    <!-- ููุชุฑุฉ ูุตุบุฑุฉ ุฃุนูู ุงูููุชุฌุงุช -->
    <div class="mini-filter-section mb-3 p-2 rounded" style="background: #f8f9fa; border: 1px solid #e9ecef;">
      <div class="row align-items-center g-2">
        <div class="col-lg-2 col-md-3 col-sm-6">
          <select id="category-filter" class="form-select form-select-sm" style="font-size: 0.85rem;">
            <option value="">ุฌููุน ุงูุชุตูููุงุช</option>
            <!-- ุณูุชู ุชุนุจุฆุฉ ุงูุชุตูููุงุช ุฏููุงููููุงู -->
          </select>
        </div>
        
        <div class="col-lg-2 col-md-3 col-sm-6">
          <select id="price-filter" class="form-select form-select-sm" style="font-size: 0.85rem;">
            <option value="">ุฌููุน ุงูุฃุณุนุงุฑ</option>
            <option value="0-1000">ุฃูู ูู 1000 ุฏุฌ</option>
            <option value="1000-5000">1000 - 5000 ุฏุฌ</option>
            <option value="5000-10000">5000 - 10000 ุฏุฌ</option>
            <option value="10000+">ุฃูุซุฑ ูู 10000 ุฏุฌ</option>
          </select>
        </div>
        
        <div class="col-lg-2 col-md-3 col-sm-6">
          <select id="sort-filter" class="form-select form-select-sm" style="font-size: 0.85rem;">
            <option value="newest">ุงูุฃุญุฏุซ</option>
            <option value="oldest">ุงูุฃูุฏู</option>
            <option value="price-low">ุงูุณุนุฑ: ูู ุงูุฃูู ููุฃุนูู</option>
            <option value="price-high">ุงูุณุนุฑ: ูู ุงูุฃุนูู ููุฃูู</option>
            <option value="name-asc">ุงูุงุณู: ุฃ-ู</option>
            <option value="name-desc">ุงูุงุณู: ู-ุฃ</option>
          </select>
        </div>
        
        <div class="col-lg-2 col-md-2 col-sm-4">
          <button id="clear-filters" class="btn btn-outline-secondary btn-sm w-100" style="border-radius: 6px; font-size: 0.8rem;">
            <i class="fas fa-redo"></i> ุฅุนุงุฏุฉ ุชุนููู
          </button>
        </div>
        
        <div class="col-lg-4 col-md-1 col-sm-2">
          <div class="search-results" id="search-results" style="display: none;">
            <small class="text-muted"><i class="fas fa-chart-bar"></i> <span id="results-count">ุชู ุงูุนุซูุฑ ุนูู <strong>0</strong> ููุชุฌ</span></small>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row g-4" id="products-list">
      <!-- ุณูุชู ุชุนุจุฆุฉ ุงูููุชุฌุงุช ุฏููุงููููุงู -->
    </div>

    <!-- ููุชุฌุงุช ุจุตูุญุงุช ุงููุจูุท -->
    <section id="landing-products-section" style="display:none;">
      <h2 class="mb-4 mt-4">ููุชุฌุงุช ุจุตูุญุงุช ุงููุจูุท</h2>
      <div class="row g-4" id="landing-products-list">
        <!-- ูุชู ุชุนุจุฆุฉ ููุชุฌุงุช ุตูุญุงุช ุงููุจูุท ุฏููุงููููุงู -->
      </div>
    </section>

    <h1 class="section-title" id="categories-section">
      ุงูุชุตูููุงุช
    </h1>
    <div class="row g-4" id="categories-list">
      <!-- ุณูุชู ุชุนุจุฆุฉ ุงูููุชุฌุงุช ุฏููุงููููุงู -->
    </div>
  </main>

  <footer class="main-footer p-3 mt-5"
          style="color: #000 !important; background: #fff; padding: 1rem 1.2rem; margin: 2rem 10px 0 10px; border-radius: 0 0 18px 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); font-size: 1rem; text-align: center;">
    <div class="mt-2 text-center">
      ุฌููุน ุงูุญููู ูุญููุธุฉ &copy; <span id="footer-store-name">ูุชุฌุฑู</span>
    </div>
    <!-- ุฃููููุงุช ูุณุงุฆู ุงูุชูุงุตู ุงูุงุฌุชูุงุนู -->
    <div class="social-media-icons text-center mt-3" id="social-media-icons" style="display: none;">
      <a href="#" class="social-icon facebook-icon" target="_blank" rel="noopener noreferrer" style="display: none;">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Facebook_Logo_%282019%29.png/1024px-Facebook_Logo_%282019%29.png" alt="Facebook" style="width: 25px; height: 25px; object-fit: contain;">
      </a>
      <a href="#" class="social-icon instagram-icon" target="_blank" rel="noopener noreferrer" style="display: none;">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e7/Instagram_logo_2016.svg/198px-Instagram_logo_2016.svg.png?20210403190622" alt="Instagram" style="width: 25px; height: 25px; object-fit: contain;">
      </a>
      <a href="#" class="social-icon whatsapp-icon" target="_blank" rel="noopener noreferrer" style="display: none;">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/2062095_application_chat_communication_logo_whatsapp_icon.svg/105px-2062095_application_chat_communication_logo_whatsapp_icon.svg.png?20220531073934" alt="WhatsApp" style="width: 25px; height: 25px; object-fit: contain;">
      </a>
      <a href="#" class="social-icon tiktok-icon" target="_blank" rel="noopener noreferrer" style="display: none;">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Ionicons_logo-tiktok.svg/768px-Ionicons_logo-tiktok.svg.png" alt="TikTok" style="width: 25px; height: 25px; object-fit: contain;">
      </a>
    </div>
  </footer>
  
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src = "js/cumun.js" type="module">
      </script>
    <script>    
  // ================================    
// ุชุญุฏูุซ ุฌููุน ุงูุฑูุงุจุท ูู ุงููููุน    
// ================================    
function updateAllLinks() {    
  // ุฑูุงุจุท ุงูุชููู ุงูุฑุฆูุณูุฉ    
  const navLinks = [    
    { id: 'nav-home', href: 'index.html' },    
    { id: 'nav-category', href: 'category.html' },    
    { id: 'nav-products', href: 'all-products.html' },    
    { id: 'nav-about', href: 'about-us.html' }    
  ];    
      
  navLinks.forEach(link => {    
    const element = document.getElementById(link.id);    
    if (element) {    
      element.href = link.href;    
    }    
  });    
    
  // ุฑูุงุจุท ุงูุณุงูุฏ ุจุงุฑ    
  const sidebarLinks = [    
    { id: 'sidebar-home', href: 'index.html' },    
    { id: 'sidebar-category', href: 'category.html' },    
    { id: 'sidebar-products', href: 'all-products.html' },    
    { id: 'sidebar-about', href: 'about-us.html' }    
  ];    
      
  sidebarLinks.forEach(link => {    
    const element = document.getElementById(link.id);    
    if (element) {    
      element.href = link.href;    
    }    
  });    
}    
    
// ================================    
// ุฅุฒุงูุฉ ุจุงุฑุงููุชุฑ subdomain ูู ุงูุฑุงุจุท    
// ================================    
function cleanSubdomainParam() {    
  const url = new URL(window.location);    
  if (url.searchParams.has('subdomain')) {    
    url.searchParams.delete('subdomain');    
    window.history.replaceState({}, document.title, url.pathname);    
  }    
}    
    
// ================================    
// ุชุดุบูู ูู ุดูุก ุนูุฏ ุชุญููู ุงูุตูุญุฉ    
// ================================    
document.addEventListener('DOMContentLoaded', () => {    
  updateAllLinks();    
  cleanSubdomainParam();    
});    
  </script>
</body>
</html>
